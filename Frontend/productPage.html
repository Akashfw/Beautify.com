<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Beautify Products</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <link href="./logos/b_icon-removebg-preview.png" rel="icon">
  <link href="./logos/b_icon-removebg-preview.png" rel="apple-touch-icon">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
  <link href="assets/vendor/remixicon/remixicon.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

  <link href="assets/css/productPage.css" rel="stylesheet">
  <link href="assets/css/style.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/2.0.11/typed.min.js"></script>
</head>
<body>
    <header id="header" class="fixed-top ">
        <div class="container d-flex align-items-center">
    
          <h1 class="logo me-auto"><a href="index.html"><span><img style="margin-bottom: 7px;" src="./logos/b_icon-removebg-preview.png" alt="logo"></span> Beautify </a></h1>
          <!-- Uncomment below if you prefer to use an image logo -->
          <!-- <a href="index.html" class="logo me-auto"><img src="assets/img/logo.png" alt="" class="img-fluid"></a> -->
    
          <nav id="navbar" class="navbar">
            <ul>
              <li><a class="nav-link scrollto " href="#hero">Home</a></li>
              <li><a class="nav-link scrollto" href="./signup.html">Signup</a></li>
              <li><a class="nav-link   scrollto" href="./login.html">Login</a></li>
              <!-- <li><a class="nav-link scrollto" href="#team">Team</a></li> -->
              <!-- <li class="dropdown"><a href="#"><span>Drop Down</span> <i class="bi bi-chevron-down"></i></a> -->
             
              </li>
              <!-- <li><a class="nav-link scrollto" href="#contact">Contact</a></li> -->
              <!-- <li><input class="nav-link scrollto" type="Search" placeholder="search here..."></li> -->
            </ul>
            <i class="bi bi-list mobile-nav-toggle"></i>
          </nav><!-- .navbar -->
    
        </div>
      </header>

     

      <div id="detail">
        <!-- <div class="total-pro">
          <p>Chennai Central - Hair</p>
          <h1>14 results for Hair in Chennai Central</h1>
          <div class="pro-recomend">
            <p>Recommended</p>
            <div></div>
          </div>
        </div> -->
      </div>
      <div class="auto-type">
        <h1 style="font-weight: 700;"><span class="typing"></span></h1>
      </div>
      <!-- Product card -->
      <div id="nodata">
        <!-- data not found -->
      </div>
      <div class="product" id="product" class="wrapper">
        <!-- <div class="p-card">
          <img class="store" src="https://images.fresha.com/locations/location-profile-images/162353/363866/d2bf595d-caa4-4f95-b335-332f13d94d44.jpg?class=width-small" alt="store_image">
          <h3>Tont&Naturals beauty</h3>
          <p>Chinmaya Nagar Stage 2, Sai Nagar, Kaliamman Koil Street, Chennai (Virugambakkam), Tamil Nadu</p>
          <div class="rating">
            <img src="./logos/star.png" alt="rating">
            <p>4.5</p>
            <h5>(${Math.floor(Math.random() * 9001) + 1000}) Reviews</h5>
          </div>
        </div> -->
      </div>
  
      <!-- ======= Footer ======= -->
    <footer id="footer">
  
      
      <div class="footer-top">
        <div class="container">
          <div class="row">
  
            <div class="col-lg-3 col-md-6 footer-contact">
              <h3><span><img width="70%" style="margin-left: -10px;" src="../Frontend/logos/BEAITIFY with icon.jpg" alt=""></span></h3>
              <p>
                A108 Adam Street <br>
                New York, NY 535022<br>
                United States <br><br>
                <strong>Phone:</strong> +1 5589 55488 55<br>
                <strong>Email:</strong> info@example.com<br>
              </p>
            </div>
  
            <div class="col-lg-3 col-md-6 footer-links">
              <h4>Useful Links</h4>
              <ul>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Home</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">About us</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Services</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Terms of service</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Privacy policy</a></li>
              </ul>
            </div>
  
            <div class="col-lg-3 col-md-6 footer-links">
              <h4>Our Services</h4>
              <ul>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Web Design</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Web Development</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Product Management</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Marketing</a></li>
                <li><i class="bx bx-chevron-right"></i> <a href="#">Graphic Design</a></li>
              </ul>
            </div>
  
            <div class="col-lg-3 col-md-6 footer-links">
              <h4>Our Social Networks</h4>
              <p>Cras fermentum odio eu feugiat lide par naso tierra videa magna derita valies</p>
              <div class="social-links mt-3">
                <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
              </div>
            </div>
  
          </div>
        </div>
      </div>
  
      
    </footer><!-- End Footer -->



      <script src="assets/vendor/aos/aos.js"></script>
      <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
      <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
      <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
      <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
      <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
      <script src="assets/vendor/php-email-form/validate.js"></script>
</body>
</html>

<script>





    let globalData = []
  //NEEDED place AND service from sessionstorage
  let userSearchProduct = JSON.parse(sessionStorage.getItem("userSearch")) || {};
  //console.log(userSearchProduct);
  let place = userSearchProduct.location || " " ;
  let service = userSearchProduct.service || " " ;

  window.addEventListener("load",()=>{
    // TECK DATA FROM LOCALSTORAGE 
    getData()
 })

  async function getData(){
    try {

        let res = await fetch("http://localhost:8080/api/search",{
          method:"POST",
          headers:{
            "Content-type": "application/json",
            // "Authorization":`${localStorage.getItem("token")}`
          },
          body: JSON.stringify({name:"hair",city:"guntur"})
        })

        let pro_data = await res.json();
        
        if(place!=" " || service != " "){
            let filterdata= pro_data.filter(function(element){
                return element.city.toLowerCase() == place.toLowerCase(); 
            })
          globalData=[...filterdata];
        }else{
          globalData = [...pro_data]
        }
        console.log(pro_data);
        
        render(globalData)
        detaileData(globalData)
    } catch (error) {
        alert(`Please Login`)
        console.log(error);
    }
  }

  function detaileData(pro_data){
    let cont = document.querySelector("#detail")
    cont.innerHTML = `
    <div class="total-pro"> 
        <div class="pro-recomend">
          <p>Recommended</p>
          <div></div>
        </div>
        // <h1>${pro_data.length} results for ${service} in ${place}</h1>
        <p>${place} - ${service}</p>
    </div>    
    `
  }
  
  
  function render(pro_data){
    let continer = document.querySelector("#product")
    continer.innerHTML = ""

    if(pro_data.length == 0){
      let cont = document.querySelector("#nodata")
      cont.innerHTML = `
          <div class="not-found">
            <h1>No Data in ${place}</h1>
            <img src="./logos/nodata.jpg" alt="No data">
          </div>
        `
    }else{
      let passRender = pro_data.map((ele)=>{
        return `
          <div class="card" class="p-card"    id="productCard" data-id=${ele._id}>
            
            <img src=${ele.image} alt="store_image">
            
            <div class="info">
              <h3>${ele.saloon}</h3>
              <p>${ele.address}</p>
              <div class="rating">
                
                <p>${ele.rating} ${ele.rating>=4.6?"Great":ele.rating<4.6 && ele.rating>=4.1?"Good":"Average"}</p>
                <h5>(${Math.floor(Math.random() * 9001) + 1000}) Reviews</h5>
                <button class="book-now">Book Now</button>
              </div>
            </div>
          </div>
        `
      })

      continer.innerHTML = passRender.join(" ")

      //pass singel data for the particular product
      // let proCard = document.querySelectorAll("#productCard")
      // for(let card of proCard){
      //   card.addEventListener("click",(e)=>{
      //     let id = e.target.dataset.id
      //     console.log(e);
      //   })
      // }

      const productCards = document.querySelectorAll('.book-now');

      productCards.forEach((card) => {
      card.addEventListener('click', (event) => {
        const id = event.currentTarget.dataset.id;
        //console.log(id);
        // store the ID inside session storage => for the next page data
        sessionStorage.setItem("productId", id)

        window.location.href = "Service_time.html"
      });
    });
    }
  }

  document.querySelector(".logo").addEventListener("click",()=>{
    window.location.href = "index.html"
  })

</script>